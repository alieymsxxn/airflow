[2021-05-16 19:55:55,468] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: bigquery_data_load.create_table 2021-05-16T14:55:30.303438+00:00 [queued]>
[2021-05-16 19:55:55,479] {taskinstance.py:669} INFO - Dependencies all met for <TaskInstance: bigquery_data_load.create_table 2021-05-16T14:55:30.303438+00:00 [queued]>
[2021-05-16 19:55:55,480] {taskinstance.py:879} INFO - 
--------------------------------------------------------------------------------
[2021-05-16 19:55:55,480] {taskinstance.py:880} INFO - Starting attempt 1 of 1
[2021-05-16 19:55:55,480] {taskinstance.py:881} INFO - 
--------------------------------------------------------------------------------
[2021-05-16 19:55:55,503] {taskinstance.py:900} INFO - Executing <Task(BigQueryOperator): create_table> on 2021-05-16T14:55:30.303438+00:00
[2021-05-16 19:55:55,507] {standard_task_runner.py:53} INFO - Started process 14063 to run task
[2021-05-16 19:55:55,579] {logging_mixin.py:112} INFO - Running %s on host %s <TaskInstance: bigquery_data_load.create_table 2021-05-16T14:55:30.303438+00:00 [running]> alieymsxxn
[2021-05-16 19:55:55,589] {bigquery_operator.py:252} INFO - Executing: 
    SELECT * except(rank)
    FROM (
        SELECT
            *,
            ROW_NUMBER() OVER (
                PARTITION BY vehicle_id ORDER BY DATETIME(date, TIME(hour, minute, 0))
            ) as rank
        FROM "ma-airflow.analytics.history") as latest
    WHERE rank = 1;
    
[2021-05-16 19:55:59,421] {taskinstance.py:1145} ERROR - BigQuery job failed. Final error was: {'reason': 'invalidQuery', 'location': 'query', 'message': 'Syntax error: Unexpected string literal "ma-airflow.analytics.history" at [9:14]'}. The job was: {'kind': 'bigquery#job', 'etag': 'hDD71rA7ktYUQN3PqCkM7Q==', 'id': 'ma-airflow:asia-south1.job_4gUWfYASHOVc0PT9OTpp5X_ezhhY', 'selfLink': 'https://bigquery.googleapis.com/bigquery/v2/projects/ma-airflow/jobs/job_4gUWfYASHOVc0PT9OTpp5X_ezhhY?location=asia-south1', 'user_email': 'airflow@ma-airflow.iam.gserviceaccount.com', 'configuration': {'query': {'query': '\n    SELECT * except(rank)\n    FROM (\n        SELECT\n            *,\n            ROW_NUMBER() OVER (\n                PARTITION BY vehicle_id ORDER BY DATETIME(date, TIME(hour, minute, 0))\n            ) as rank\n        FROM "ma-airflow.analytics.history") as latest\n    WHERE rank = 1;\n    ', 'destinationTable': {'projectId': 'ma-airflow', 'datasetId': 'analytics', 'tableId': 'latest'}, 'createDisposition': 'CREATE_IF_NEEDED', 'writeDisposition': 'WRITE_TRUNCATE', 'priority': 'INTERACTIVE', 'allowLargeResults': False, 'useLegacySql': False}, 'jobType': 'QUERY'}, 'jobReference': {'projectId': 'ma-airflow', 'jobId': 'job_4gUWfYASHOVc0PT9OTpp5X_ezhhY', 'location': 'asia-south1'}, 'statistics': {'creationTime': '1621176958400', 'startTime': '1621176958479', 'endTime': '1621176958480'}, 'status': {'errorResult': {'reason': 'invalidQuery', 'location': 'query', 'message': 'Syntax error: Unexpected string literal "ma-airflow.analytics.history" at [9:14]'}, 'errors': [{'reason': 'invalidQuery', 'location': 'query', 'message': 'Syntax error: Unexpected string literal "ma-airflow.analytics.history" at [9:14]'}], 'state': 'DONE'}}
Traceback (most recent call last):
  File "/home/alieymsxxn/anaconda3/envs/airflow/lib/python3.7/site-packages/airflow/models/taskinstance.py", line 983, in _run_raw_task
    result = task_copy.execute(context=context)
  File "/home/alieymsxxn/anaconda3/envs/airflow/lib/python3.7/site-packages/airflow/contrib/operators/bigquery_operator.py", line 279, in execute
    encryption_configuration=self.encryption_configuration
  File "/home/alieymsxxn/anaconda3/envs/airflow/lib/python3.7/site-packages/airflow/contrib/hooks/bigquery_hook.py", line 910, in run_query
    return self.run_with_configuration(configuration)
  File "/home/alieymsxxn/anaconda3/envs/airflow/lib/python3.7/site-packages/airflow/contrib/hooks/bigquery_hook.py", line 1344, in run_with_configuration
    format(job['status']['errorResult'], job))
Exception: BigQuery job failed. Final error was: {'reason': 'invalidQuery', 'location': 'query', 'message': 'Syntax error: Unexpected string literal "ma-airflow.analytics.history" at [9:14]'}. The job was: {'kind': 'bigquery#job', 'etag': 'hDD71rA7ktYUQN3PqCkM7Q==', 'id': 'ma-airflow:asia-south1.job_4gUWfYASHOVc0PT9OTpp5X_ezhhY', 'selfLink': 'https://bigquery.googleapis.com/bigquery/v2/projects/ma-airflow/jobs/job_4gUWfYASHOVc0PT9OTpp5X_ezhhY?location=asia-south1', 'user_email': 'airflow@ma-airflow.iam.gserviceaccount.com', 'configuration': {'query': {'query': '\n    SELECT * except(rank)\n    FROM (\n        SELECT\n            *,\n            ROW_NUMBER() OVER (\n                PARTITION BY vehicle_id ORDER BY DATETIME(date, TIME(hour, minute, 0))\n            ) as rank\n        FROM "ma-airflow.analytics.history") as latest\n    WHERE rank = 1;\n    ', 'destinationTable': {'projectId': 'ma-airflow', 'datasetId': 'analytics', 'tableId': 'latest'}, 'createDisposition': 'CREATE_IF_NEEDED', 'writeDisposition': 'WRITE_TRUNCATE', 'priority': 'INTERACTIVE', 'allowLargeResults': False, 'useLegacySql': False}, 'jobType': 'QUERY'}, 'jobReference': {'projectId': 'ma-airflow', 'jobId': 'job_4gUWfYASHOVc0PT9OTpp5X_ezhhY', 'location': 'asia-south1'}, 'statistics': {'creationTime': '1621176958400', 'startTime': '1621176958479', 'endTime': '1621176958480'}, 'status': {'errorResult': {'reason': 'invalidQuery', 'location': 'query', 'message': 'Syntax error: Unexpected string literal "ma-airflow.analytics.history" at [9:14]'}, 'errors': [{'reason': 'invalidQuery', 'location': 'query', 'message': 'Syntax error: Unexpected string literal "ma-airflow.analytics.history" at [9:14]'}], 'state': 'DONE'}}
[2021-05-16 19:55:59,428] {taskinstance.py:1202} INFO - Marking task as FAILED.dag_id=bigquery_data_load, task_id=create_table, execution_date=20210516T145530, start_date=20210516T145555, end_date=20210516T145559
[2021-05-16 19:56:05,444] {logging_mixin.py:112} INFO - [2021-05-16 19:56:05,443] {local_task_job.py:103} INFO - Task exited with return code 1
